<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GG Point - –¢–µ—Å—Ç–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* –í—Å–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ */
        /* –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è */

        /* üéØ –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤ */
        .reviews-section {
            margin-top: 3rem;
            padding: 2rem;
            background: var(--card-bg);
            border-radius: 15px;
            border: 1px solid #334155;
        }

        .reviews-title {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .no-reviews {
            text-align: center;
            color: var(--text-gray);
            padding: 2rem;
            font-style: italic;
        }

        .review-form {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        .review-input-group {
            margin-bottom: 1rem;
        }

        .review-input-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-light);
            font-weight: 600;
        }

        .review-input-group input, .review-input-group textarea {
            width: 100%;
            padding: 0.8rem;
            background: var(--dark-bg);
            border: 1px solid #334155;
            border-radius: 8px;
            color: var(--text-light);
        }

        .review-input-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .add-review-btn {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .review {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-blue);
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .review-author {
            font-weight: bold;
            color: var(--primary-blue);
        }

        .review-date {
            color: var(--text-gray);
            font-size: 0.9rem;
        }

        .review-rating {
            color: #fbbf24;
            margin-bottom: 0.5rem;
        }

        .review-text {
            color: var(--text-gray);
            line-height: 1.5;
        }

        /* ‚ú® –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∞–¥–º–∏–Ω–∫–µ */
        .edit-product-btn {
            background: var(--accent-teal);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 0.5rem;
            transition: all 0.3s ease;
        }

        .edit-product-btn:hover {
            background: #0f766e;
            transform: scale(1.05);
        }

        .main-text {
            font-size: 1.4rem;
            color: var(--text-light);
            margin-bottom: 2rem;
            font-weight: 600;
            text-align: center;
        }

        .test-info {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 2rem;
            max-width: 500px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border-radius: 10px;
            border: 1px solid #3b82f6;
        }

        .info-item i {
            color: #3b82f6;
            font-size: 1.2rem;
            width: 24px;
        }

        .info-item span {
            color: var(--text-light);
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <!-- –í–µ—Å—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π HTML –∫–æ–¥ –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->
    <!-- –ú–µ–Ω—è–µ–º —Ç–æ–ª—å–∫–æ JavaScript -->

    <script type="module">
        // üî• –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Firebase
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js';
        import { getDatabase, ref, onValue, set, remove } from 'https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js';

        // üéØ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyDcyOWAF7TA8h8P36Sk5EbDPzA9sEFuTXo",
            authDomain: "ggpoint-shop.firebaseapp.com",
            databaseURL: "https://ggpoint-shop-default-rtdb.firebaseio.com",
            projectId: "ggpoint-shop",
            storageBucket: "ggpoint-shop.firebasestorage.app",
            messagingSenderId: "182227173652",
            appId: "1:182227173652:web:0949e2edae9900afd98201",
            measurementId: "G-V76H7K3VR4"
        };

        // üöÄ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        let products = [];
        let filteredProducts = [];
        let currentImageIndex = 0;
        let editingProductId = null;

        // üì• –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ Firebase
        function loadProducts() {
            console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∏–∑ Firebase...');
            
            const productsRef = ref(database, 'products');
            
            onValue(productsRef, (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –æ–±—ä–µ–∫—Ç –≤ –º–∞—Å—Å–∏–≤ –∏ –¥–æ–±–∞–≤–ª—è–µ–º –æ—Ç–∑—ã–≤—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                    products = Object.values(data).map(product => {
                        if (!product.reviews) {
                            product.reviews = [];
                        }
                        return product;
                    });
                    console.log('‚úÖ –¢–æ–≤–∞—Ä—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', products.length);
                    updateCategoryCounts();
                } else {
                    products = [];
                    console.log('üìù –ë–∞–∑–∞ –ø—É—Å—Ç–∞—è, –Ω–∞—á–∏–Ω–∞–µ–º —Å –Ω—É–ª—è');
                    updateCategoryCounts();
                }
                applyFilters();
            }, (error) => {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                products = getDefaultProducts();
                updateCategoryCounts();
                applyFilters();
            });
        }

        // üî¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–æ–≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function updateCategoryCounts() {
            const mouseCount = products.filter(p => p.category === '–º—ã—à—å').length;
            const keyboardCount = products.filter(p => p.category === '–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞').length;
            const headphonesCount = products.filter(p => p.category === '–Ω–∞—É—à–Ω–∏–∫–∏').length;

            document.getElementById('mouseCount').textContent = `${mouseCount} —Ç–æ–≤–∞—Ä–æ–≤`;
            document.getElementById('keyboardCount').textContent = `${keyboardCount} —Ç–æ–≤–∞—Ä–æ–≤`;
            document.getElementById('headphonesCount').textContent = `${headphonesCount} —Ç–æ–≤–∞—Ä–æ–≤`;
        }

        // üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ Firebase
        async function saveProduct(product) {
            try {
                const productRef = ref(database, 'products/' + product.id);
                await set(productRef, product);
                console.log('‚úÖ –¢–æ–≤–∞—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Firebase');
                return true;
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
                return false;
            }
        }

        // üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–∑ Firebase
        async function deleteProductFromFirebase(productId) {
            try {
                const productRef = ref(database, 'products/' + productId);
                await remove(productRef);
                console.log('‚úÖ –¢–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –∏–∑ Firebase');
                return true;
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è:', error);
                return false;
            }
        }

        // üì¶ –¢–æ–≤–∞—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        function getDefaultProducts() {
            return [
                {
                    id: 1,
                    name: "–ò–≥—Ä–æ–≤–∞—è –º—ã—à—å Razer DeathAdder V2",
                    category: "–º—ã—à—å",
                    price: "799,000 UZS",
                    images: [
                        "https://images.unsplash.com/photo-1527864550417-7fd91fc51a46?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80",
                        "https://images.unsplash.com/photo-1541140532154-b024d705b90a?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80"
                    ],
                    description: "–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –º—ã—à—å —Å —Å–µ–Ω—Å–æ—Ä–æ–º 20K DPI –∏ 7 –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏.",
                    video: "dQw4w9WgXcQ",
                    features: ["–°–µ–Ω—Å–æ—Ä 20K DPI", "7 –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä—É–µ–º—ã—Ö –∫–Ω–æ–ø–æ–∫", "–û–ø—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏"],
                    reviews: [
                        {
                            id: 1,
                            author: "–ê–ª–µ–∫—Å–µ–π",
                            rating: 5,
                            text: "–û—Ç–ª–∏—á–Ω–∞—è –º—ã—à—å, –æ—á–µ–Ω—å —É–¥–æ–±–Ω–∞—è!",
                            date: "2024-01-15"
                        }
                    ]
                }
            ];
        }

        // üéØ –§—É–Ω–∫—Ü–∏–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ (–æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        function applyFilters() {
            const category = document.getElementById('categoryFilter').value;
            const sortBy = document.getElementById('priceSort').value;
            const searchQuery = document.getElementById('searchInput').value.toLowerCase();

            filteredProducts = [...products];

            if (category !== 'all') {
                filteredProducts = filteredProducts.filter(product => 
                    product.category === category
                );
            }

            if (searchQuery) {
                filteredProducts = filteredProducts.filter(product =>
                    product.name.toLowerCase().includes(searchQuery)
                );
            }

            if (sortBy === 'price_asc') {
                filteredProducts.sort((a, b) => parsePrice(a.price) - parsePrice(b.price));
            } else if (sortBy === 'price_desc') {
                filteredProducts.sort((a, b) => parsePrice(b.price) - parsePrice(a.price));
            }

            renderProducts();
            updateProductsCount();
        }

        // üí∞ –ü–∞—Ä—Å–∏–Ω–≥ —Ü–µ–Ω—ã
        function parsePrice(priceStr) {
            const cleanPrice = priceStr.replace(/[^\d,]/g, '').replace(',', '');
            return parseInt(cleanPrice) || 0;
        }

        // üî¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
        function updateProductsCount() {
            const countElement = document.getElementById('productsCount');
            countElement.textContent = `–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${filteredProducts.length}`;
        }

        // üé® –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
        function renderProducts() {
            const grid = document.getElementById('productsGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            filteredProducts.forEach(product => {
                const shortDescription = product.description.length > 100 
                    ? product.description.substring(0, 100) + '...' 
                    : product.description;

                const mainImage = product.images && product.images.length > 0 
                    ? product.images[0] 
                    : 'https://via.placeholder.com/300x200?text=No+Image';

                const card = document.createElement('div');
                card.className = 'product-card fade-in-up';
                card.innerHTML = `
                    <div class="product-badge">${product.images && product.images.length > 1 ? 'üì∏ ' + product.images.length + ' —Ñ–æ—Ç–æ' : '–ù–û–í–ò–ù–ö–ê'}</div>
                    <img src="${mainImage}" alt="${product.name}" class="product-image">
                    <div class="product-info">
                        <div class="product-category">${getCategoryName(product.category)}</div>
                        <h3 class="product-name">${product.name}</h3>
                        <p class="product-description-short">${shortDescription}</p>
                        <div class="product-rating">
                            <div class="stars">
                                ${getRatingStars(4.5)}
                            </div>
                            <span class="rating-value">4.5/5</span>
                        </div>
                        <p class="product-price">${product.price}</p>
                    </div>
                `;
                
                card.addEventListener('click', () => openProductDetail(product));
                grid.appendChild(card);
            });
        }

        // ‚≠ê –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–≤–µ–∑–¥ —Ä–µ–π—Ç–∏–Ω–≥–∞
        function getRatingStars(rating) {
            let stars = '';
            for (let i = 1; i <= 5; i++) {
                if (i <= Math.floor(rating)) {
                    stars += '<i class="fas fa-star"></i>';
                } else if (i === Math.ceil(rating) && rating % 1 !== 0) {
                    stars += '<i class="fas fa-star-half-alt"></i>';
                } else {
                    stars += '<i class="far fa-star"></i>';
                }
            }
            return stars;
        }

        // üè∑Ô∏è –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function getCategoryName(category) {
            const categories = {
                '–º—ã—à—å': '–ò–≥—Ä–æ–≤–∞—è –º—ã—à—å',
                '–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞': '–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞', 
                '–º–æ–Ω–∏—Ç–æ—Ä': '–ú–æ–Ω–∏—Ç–æ—Ä',
                '–Ω–∞—É—à–Ω–∏–∫–∏': '–ù–∞—É—à–Ω–∏–∫–∏',
                '–∫—Ä–µ—Å–ª–æ': '–ö—Ä–µ—Å–ª–æ',
                '–∫–æ–≤—Ä–∏–∫': '–ö–æ–≤—Ä–∏–∫'
            };
            return categories[category] || category;
        }

        // üîç –û—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ—Ç–∞–ª–µ–π —Ç–æ–≤–∞—Ä–∞
        function openProductDetail(product) {
            const modal = document.getElementById('productDetailModal');
            const content = document.getElementById('productDetailContent');
            
            if (!modal || !content) return;
            
            currentImageIndex = 0;
            
            let videoHTML = '';
            if (product.video && product.video.trim() !== '') {
                // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º YouTube —Å—Å—ã–ª–∫–∏
                let videoId = product.video;
                // –ï—Å–ª–∏ —ç—Ç–æ –ø–æ–ª–Ω–∞—è —Å—Å—ã–ª–∫–∞, –∏–∑–≤–ª–µ–∫–∞–µ–º ID
                if (product.video.includes('youtube.com') || product.video.includes('youtu.be')) {
                    const match = product.video.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);
                    videoId = match ? match[1] : product.video;
                }
                
                videoHTML = `
                    <div class="video-container">
                        <h3><i class="fab fa-youtube"></i> –û–±–∑–æ—Ä —Ç–æ–≤–∞—Ä–∞</h3>
                        <iframe src="https://www.youtube.com/embed/${videoId}" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                        </iframe>
                    </div>
                `;
            }

            let featuresHTML = '';
            if (product.features && product.features.length > 0) {
                featuresHTML = `
                    <div class="product-features">
                        <h3><i class="fas fa-list-check"></i> –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
                        <ul class="feature-list">
                            ${product.features.map(feature => `<li>${feature}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }

            // –ì–∞–ª–µ—Ä–µ—è —Ñ–æ—Ç–æ
            let galleryHTML = '';
            if (product.images && product.images.length > 0) {
                const hasMultipleImages = product.images.length > 1;
                
                galleryHTML = `
                    <div class="product-gallery">
                        <div class="main-image">
                            <img src="${product.images[0]}" alt="${product.name}" id="mainProductImage">
                            ${hasMultipleImages ? `
                            <div class="gallery-nav">
                                <button class="nav-btn" onclick="prevImage()">
                                    <i class="fas fa-chevron-left"></i>
                                </button>
                                <button class="nav-btn" onclick="nextImage()">
                                    <i class="fas fa-chevron-right"></i>
                                </button>
                            </div>
                            ` : ''}
                        </div>
                        ${hasMultipleImages ? `
                        <div class="image-thumbnails">
                            ${product.images.map((image, index) => `
                                <img src="${image}" alt="${product.name} —Ñ–æ—Ç–æ ${index + 1}" 
                                     class="thumbnail ${index === 0 ? 'active' : ''}"
                                     onclick="changeImage(${index})">
                            `).join('')}
                        </div>
                        ` : ''}
                    </div>
                `;
            } else {
                galleryHTML = `
                    <div class="product-gallery">
                        <div class="main-image">
                            <img src="https://via.placeholder.com/500x400?text=No+Image" alt="No image">
                        </div>
                    </div>
                `;
            }

            // –û—Ç–∑—ã–≤—ã
            let reviewsHTML = '';
            if (product.reviews && product.reviews.length > 0) {
                reviewsHTML = `
                    <div class="reviews-section">
                        <h3 class="reviews-title"><i class="fas fa-comments"></i> –û—Ç–∑—ã–≤—ã</h3>
                        ${product.reviews.map(review => `
                            <div class="review">
                                <div class="review-header">
                                    <span class="review-author">${review.author}</span>
                                    <span class="review-date">${review.date}</span>
                                </div>
                                <div class="review-rating">
                                    ${getRatingStars(review.rating)}
                                </div>
                                <div class="review-text">${review.text}</div>
                            </div>
                        `).join('')}
                        
                        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞ -->
                        <div class="review-form">
                            <h4>–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h4>
                            <div class="review-input-group">
                                <label for="reviewAuthor">–í–∞—à–µ –∏–º—è</label>
                                <input type="text" id="reviewAuthor" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                            </div>
                            <div class="review-input-group">
                                <label for="reviewRating">–û—Ü–µ–Ω–∫–∞</label>
                                <select id="reviewRating">
                                    <option value="5">5 –∑–≤–µ–∑–¥</option>
                                    <option value="4">4 –∑–≤–µ–∑–¥—ã</option>
                                    <option value="3">3 –∑–≤–µ–∑–¥—ã</option>
                                    <option value="2">2 –∑–≤–µ–∑–¥—ã</option>
                                    <option value="1">1 –∑–≤–µ–∑–¥–∞</option>
                                </select>
                            </div>
                            <div class="review-input-group">
                                <label for="reviewText">–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞</label>
                                <textarea id="reviewText" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–∑—ã–≤..."></textarea>
                            </div>
                            <button class="add-review-btn" onclick="addReview(${product.id})">
                                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
                            </button>
                        </div>
                    </div>
                `;
            } else {
                reviewsHTML = `
                    <div class="reviews-section">
                        <h3 class="reviews-title"><i class="fas fa-comments"></i> –û—Ç–∑—ã–≤—ã</h3>
                        <div class="no-reviews">
                            <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
                        </div>
                        
                        <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∑—ã–≤–∞ -->
                        <div class="review-form">
                            <h4>–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤</h4>
                            <div class="review-input-group">
                                <label for="reviewAuthor">–í–∞—à–µ –∏–º—è</label>
                                <input type="text" id="reviewAuthor" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
                            </div>
                            <div class="review-input-group">
                                <label for="reviewRating">–û—Ü–µ–Ω–∫–∞</label>
                                <select id="reviewRating">
                                    <option value="5">5 –∑–≤–µ–∑–¥</option>
                                    <option value="4">4 –∑–≤–µ–∑–¥—ã</option>
                                    <option value="3">3 –∑–≤–µ–∑–¥—ã</option>
                                    <option value="2">2 –∑–≤–µ–∑–¥—ã</option>
                                    <option value="1">1 –∑–≤–µ–∑–¥–∞</option>
                                </select>
                            </div>
                            <div class="review-input-group">
                                <label for="reviewText">–¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞</label>
                                <textarea id="reviewText" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–∑—ã–≤..."></textarea>
                            </div>
                            <button class="add-review-btn" onclick="addReview(${product.id})">
                                <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤
                            </button>
                        </div>
                    </div>
                `;
            }
            
            content.innerHTML = `
                <h2>${product.name}</h2>
                <div class="product-category">${getCategoryName(product.category)}</div>
                <div class="product-detail-grid">
                    ${galleryHTML}
                    <div class="product-details">
                        <p class="product-price">${product.price}</p>
                        <div class="product-description-full">
                            <h3><i class="fas fa-align-left"></i> –û–ø–∏—Å–∞–Ω–∏–µ</h3>
                            <p>${product.description}</p>
                        </div>
                        ${featuresHTML}
                        <div class="photo-count">
                            <i class="fas fa-camera"></i>
                            –î–æ—Å—Ç—É–ø–Ω–æ —Ñ–æ—Ç–æ: ${product.images ? product.images.length : 0}
                        </div>
                    </div>
                </div>
                ${videoHTML}
                ${reviewsHTML}
            `;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ñ–æ—Ç–æ
            window.currentProduct = product;
            
            modal.style.display = 'block';
        }

        // üí¨ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
        window.addReview = async function(productId) {
            const author = document.getElementById('reviewAuthor').value;
            const rating = parseInt(document.getElementById('reviewRating').value);
            const text = document.getElementById('reviewText').value;
            
            if (!author || !text) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            const product = products.find(p => p.id === productId);
            if (product) {
                const newReview = {
                    id: Date.now(),
                    author: author,
                    rating: rating,
                    text: text,
                    date: new Date().toISOString().split('T')[0]
                };
                
                if (!product.reviews) {
                    product.reviews = [];
                }
                
                product.reviews.push(newReview);
                
                const success = await saveProduct(product);
                if (success) {
                    alert('‚úÖ –û—Ç–∑—ã–≤ –¥–æ–±–∞–≤–ª–µ–Ω!');
                    // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
                    document.getElementById('reviewAuthor').value = '';
                    document.getElementById('reviewRating').value = '5';
                    document.getElementById('reviewText').value = '';
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä
                    openProductDetail(product);
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –æ—Ç–∑—ã–≤–∞');
                }
            }
        };

        // üñºÔ∏è –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ —Ñ–æ—Ç–æ (–æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        window.changeImage = function(index) {
            if (window.currentProduct && window.currentProduct.images) {
                currentImageIndex = index;
                document.getElementById('mainProductImage').src = window.currentProduct.images[index];
                
                document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
                    thumb.classList.toggle('active', i === index);
                });
            }
        };

        window.nextImage = function() {
            if (window.currentProduct && window.currentProduct.images) {
                currentImageIndex = (currentImageIndex + 1) % window.currentProduct.images.length;
                changeImage(currentImageIndex);
            }
        };

        window.prevImage = function() {
            if (window.currentProduct && window.currentProduct.images) {
                currentImageIndex = (currentImageIndex - 1 + window.currentProduct.images.length) % window.currentProduct.images.length;
                changeImage(currentImageIndex);
            }
        };

        // üë®‚Äçüíº –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∫–∏ —Å —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º
        function initAdmin() {
            // ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –∞–¥–º–∏–Ω–∫–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...

            // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
            document.getElementById('manageProductsBtn').addEventListener('click', () => {
                showAdminSection('manageProductsSection');
                renderAdminProducts();
            });

            // –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞
            document.getElementById('addProductForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const name = document.getElementById('productName').value;
                const category = document.getElementById('productCategory').value;
                const price = document.getElementById('productPrice').value;
                const description = document.getElementById('productDescription').value;
                const video = document.getElementById('productVideo').value;
                
                // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ URL —Ñ–æ—Ç–æ
                const imageInputs = document.querySelectorAll('.image-url-input');
                const images = Array.from(imageInputs)
                    .map(input => input.value.trim())
                    .filter(url => url.length > 0);
                
                if (images.length === 0) {
                    alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Ñ–æ—Ç–æ —Ç–æ–≤–∞—Ä–∞');
                    return;
                }
                
                let productData = {
                    name: name,
                    category: category,
                    price: price,
                    images: images,
                    description: description,
                    video: video,
                    features: []
                };
                
                let success;
                if (editingProductId) {
                    // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç–æ–≤–∞—Ä–∞
                    const existingProduct = products.find(p => p.id === editingProductId);
                    productData = {
                        ...existingProduct,
                        ...productData
                    };
                    success = await saveProduct(productData);
                    editingProductId = null;
                    document.getElementById('addProductForm').querySelector('.submit-btn').innerHTML = '<i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä';
                } else {
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
                    productData.id = Date.now();
                    productData.reviews = [];
                    success = await saveProduct(productData);
                }
                
                if (success) {
                    document.getElementById('addProductForm').reset();
                    const container = document.getElementById('imageInputsContainer');
                    container.innerHTML = `
                        <div class="image-input-group">
                            <div class="image-input-wrapper">
                                <input type="text" class="image-url-input" required placeholder="https://example.com/photo1.jpg">
                            </div>
                        </div>
                    `;
                    document.getElementById('imagePreview').style.display = 'none';
                    alert(editingProductId ? '‚úÖ –¢–æ–≤–∞—Ä –æ–±–Ω–æ–≤–ª–µ–Ω!' : '‚úÖ –¢–æ–≤–∞—Ä —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!');
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–∞');
                }
            });
        }

        // ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
        window.editProduct = function(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                editingProductId = productId;
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞
                document.getElementById('productName').value = product.name;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productPrice').value = product.price;
                document.getElementById('productDescription').value = product.description;
                document.getElementById('productVideo').value = product.video || '';
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ç–æ
                const container = document.getElementById('imageInputsContainer');
                container.innerHTML = '';
                if (product.images && product.images.length > 0) {
                    product.images.forEach((image, index) => {
                        const imageGroup = document.createElement('div');
                        imageGroup.className = 'image-input-group';
                        imageGroup.innerHTML = `
                            <div class="image-input-wrapper">
                                <input type="text" class="image-url-input" required value="${image}" placeholder="https://example.com/photo.jpg">
                                ${index > 0 ? `<button type="button" class="remove-image-btn" onclick="this.parentElement.parentElement.remove(); updateImagePreview();">
                                    <i class="fas fa-times"></i>
                                </button>` : ''}
                            </div>
                        `;
                        container.appendChild(imageGroup);
                    });
                } else {
                    container.innerHTML = `
                        <div class="image-input-group">
                            <div class="image-input-wrapper">
                                <input type="text" class="image-url-input" required placeholder="https://example.com/photo1.jpg">
                            </div>
                        </div>
                    `;
                }
                
                updateImagePreview();
                showAdminSection('addProductSection');
                document.getElementById('addProductForm').querySelector('.submit-btn').innerHTML = '<i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ñ–æ—Ä–º–µ
                document.getElementById('addProductSection').scrollIntoView({ behavior: 'smooth' });
            }
        };

        // üìã –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        function renderAdminProducts() {
            const adminList = document.getElementById('adminProductsList');
            if (!adminList) return;
            
            adminList.innerHTML = '';
            
            if (products.length === 0) {
                adminList.innerHTML = '<p style="text-align: center; color: var(--text-gray); padding: 2rem;">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                return;
            }
            
            products.forEach(product => {
                const productItem = document.createElement('div');
                productItem.className = 'product-card';
                productItem.style.marginBottom = '1rem';
                productItem.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 1.5rem; padding: 1.5rem;">
                        <img src="${product.images && product.images.length > 0 ? product.images[0] : 'https://via.placeholder.com/100x100?text=No+Image'}" 
                             alt="${product.name}" 
                             style="width: 100px; height: 100px; object-fit: cover; border-radius: 10px;">
                        <div style="flex: 1;">
                            <h4 style="margin-bottom: 0.5rem; color: var(--text-light);">${product.name}</h4>
                            <p style="color: var(--accent-teal); font-weight: bold; margin-bottom: 0.5rem;">${product.price}</p>
                            <p style="color: var(--text-gray); font-size: 0.9rem;">
                                ${getCategoryName(product.category)} ‚Ä¢ 
                                ${product.images ? 'üì∏ ' + product.images.length + ' —Ñ–æ—Ç–æ' : 'üì∑ –ù–µ—Ç —Ñ–æ—Ç–æ'} ‚Ä¢ 
                                ${product.video ? 'üìπ –ï—Å—Ç—å –≤–∏–¥–µ–æ' : 'üé¨ –ù–µ—Ç –≤–∏–¥–µ–æ'} ‚Ä¢ 
                                ${product.reviews ? 'üí¨ ' + product.reviews.length + ' –æ—Ç–∑—ã–≤–æ–≤' : 'üí¨ –ù–µ—Ç –æ—Ç–∑—ã–≤–æ–≤'} ‚Ä¢ 
                                ID: ${product.id}
                            </p>
                        </div>
                        <div style="display: flex; gap: 0.5rem;">
                            <button onclick="editProduct(${product.id})" class="edit-product-btn">
                                <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                            <button onclick="adminDeleteProduct(${product.id})" 
                                    style="background: #ef4444; color: white; border: none; padding: 0.7rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 600;">
                                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </div>
                    </div>
                `;
                adminList.appendChild(productItem);
            });
        }

        // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π...
        // (initAdmin, addImageInput, updateImagePreview, showAdminSection, adminDeleteProduct, exportToJSON)

        // üåê –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.adminDeleteProduct = adminDeleteProduct;
        window.addImageInput = addImageInput;
        window.updateImagePreview = updateImagePreview;
        window.editProduct = editProduct;
        window.changeImage = changeImage;
        window.nextImage = nextImage;
        window.prevImage = prevImage;
        window.addReview = addReview;

        // üéØ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ GGPoint –∫–∞—Ç–∞–ª–æ–≥ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è...');
            
            loadProducts();
            initAdmin();
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            document.getElementById('categoryFilter').addEventListener('change', applyFilters);
            document.getElementById('priceSort').addEventListener('change', applyFilters);
            document.getElementById('searchInput').addEventListener('input', applyFilters);

            // –ö–ª–∏–∫ –ø–æ –∫–Ω–æ–ø–∫–µ –∫–∞—Ç–∞–ª–æ–≥–∞
            document.getElementById('catalogBtn').addEventListener('click', function() {
                document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
            });

            // –ö–ª–∏–∫ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            document.querySelectorAll('.category-card').forEach(card => {
                card.addEventListener('click', function() {
                    const category = this.dataset.category;
                    document.getElementById('categoryFilter').value = category;
                    applyFilters();
                    document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
                });
            });

            // –ü–ª–∞–≤–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –ø–æ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('nav a').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ ESC
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                }
            });

            console.log('‚úÖ GGPoint –∫–∞—Ç–∞–ª–æ–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω!');
        });
    </script>
</body>
</html>
